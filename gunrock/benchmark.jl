include("consts.jl")
include("pagerank.jl")
include("sssp.jl")
include("bc.jl")
include("bfs.jl")
include("cc.jl")
using JLD, LightGraphs
function benchmark()
	warmup()
	for k in [10^4, 10^5, 10^6, 10^7]
		info("dim = $k X $k")
		a = sprand(k, k, 1/k)
		#a = spones(a)
		a = a + a'
		g = Graph(a)
		g1 = DiGraph(a)
		t11 = @elapsed bfs(a, 1)
		t12 = @elapsed bfs_tree(g, 1) 
		t21 = @elapsed cc(a, 1)
		t22 = @elapsed connected_components(g)
		t31 = @elapsed pageran(a)
		t32 = @elapsed LightGraphs.pagerank(g1)
		t41 = @elapsed sssp(a, 1)
		t42 = @elapsed dijkstra_shortest_paths(g, 1)
		t51 = @elapsed bc(a, 1)
		t52 = @elapsed betweenness_centrality(g, 1)
		println("Time taken for bfs on gunrock= $t11")		
		println("Time taken for bfs on lightgraphs= $t12")		
		println("Time taken for cc on gunrock= $t21")		
		println("Time taken for cc on lightgraphs $t22")		
		println("Time taken for pagerank on gunrock= $t31")		
		println("Time taken for pagerank on lightgraphs $t32")		
		println("Time taken for sssp on gunrock= $t41")		
		println("Time taken for sssp on lightgraphs $t42")		
		println("Time taken for bc on gunrock $t51")		
		println("Time taken for bc on lightgraphs $t52")		
	end
end

function warmup()
	a = sprand(100,100,0.1)
	a = spones(a)
	bfs(a,1)
	cc(a,1)
	pageran(a)
	sssp(a,1)
	bc(a,1)
	info("warmup done.")
end

function realdata_benchmark()
	warmup()
	
	a = JLD.load("/home/ubuntu/GPU-benchmarking/graph.jld")["T"]
	colptr = deepcopy(a.colptr)
	final = colptr[end]
	extra = fill(final, a.m - 473)
	append!(colptr, extra)
	amod = SparseMatrixCSC(a.m, a.m, colptr, a.rowval, a.nzval)
	amod = amod + amod'
	amod = round(Float64, amod)
	g = Graph(amod)
	g1 = DiGraph(amod)
	t11 = @elapsed bfs(amod, 1)
	t12 = @elapsed bfs_tree(g, 1) 
	t21 = @elapsed cc(amod, 1)
	t22 = @elapsed connected_components(g)
	t31 = @elapsed pageran(amod)
	t32 = @elapsed LightGraphs.pagerank(g1)
	t41 = @elapsed sssp(amod, 1)
	t42 = @elapsed dijkstra_shortest_paths(g, 1)
	t51 = @elapsed bc(amod, 1)
	t52 = @elapsed betweenness_centrality(g, 1)
	println("Time taken for bfs on gunrock= $t11")		
	println("Time taken for bfs on lightgraphs= $t12")		
	println("Time taken for cc on gunrock= $t21")		
	println("Time taken for cc on lightgraphs $t22")		
	println("Time taken for pagerank on gunrock= $t31")		
	println("Time taken for pagerank on lightgraphs $t32")		
	println("Time taken for sssp on gunrock= $t41")		
	println("Time taken for sssp on lightgraphs $t42")		
	println("Time taken for bc on gunrock= $t51")		
	println("Time taken for bc on lightgraphs $t52")		
end
